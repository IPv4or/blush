<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>blush - JUNE 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* Dark background */
            color: #F3F4F6;
        }
        .upload-btn-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }
        .btn {
            border: 2px solid #38BDF8;
            color: #F3F4F6;
            background-color: transparent;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background-color: #38BDF8;
            color: #111827;
        }
        .upload-btn-wrapper input[type=file] {
            font-size: 100px;
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
        }
        canvas {
            border-radius: 8px;
            background-color: #1F2937; /* Slightly lighter than body */
            border: 1px solid #374151;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="antialiased">
    <div class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 lg:p-8">
        <div class="w-full max-w-2xl text-center">
            
            <!-- Header -->
            <header class="mb-8">
                <img src="https://storage.googleapis.com/gemini-prod-us-west1-assets/d92f827f-8cd5-48b2-b532-5647ed0b0131" alt="blush logo" class="w-48 h-auto mx-auto mb-4">
                <h1 class="text-4xl sm:text-5xl font-bold tracking-tight text-white">JUNE 2025</h1>
                <p class="mt-4 text-lg text-gray-400">Create your own poster for the release.</p>
            </header>

            <!-- Interactive Section -->
            <div class="bg-gray-800 p-6 rounded-lg shadow-xl w-full">
                <!-- File Uploader -->
                <div class="upload-btn-wrapper mb-6">
                    <button class="btn" id="upload-label">Upload an Image (PNG/JPEG)</button>
                    <input type="file" id="imageLoader" name="imageLoader" accept="image/png, image/jpeg"/>
                </div>

                <!-- Canvas for Image Manipulation -->
                <p id="instruction" class="text-gray-500 mb-4">Your creation will appear here.</p>
                <canvas id="imageCanvas" class="w-full h-auto"></canvas>

                <!-- Download Button -->
                <div id="downloadContainer" class="mt-6 hidden">
                    <button id="downloadBtn" class="btn w-full sm:w-auto">Download Masterpiece</button>
                </div>
                
                 <!-- Error Message Box -->
                <div id="error-box" class="hidden mt-4 bg-red-900 border border-red-700 text-red-200 px-4 py-3 rounded-lg relative" role="alert">
                    <strong class="font-bold">Error:</strong>
                    <span class="block sm:inline" id="error-message"></span>
                </div>
            </div>

            <!-- Footer -->
            <footer class="mt-12 text-gray-500">
                <p>&copy; 2025 BLUSH. All rights reserved.</p>
            </footer>

        </div>
    </div>

    <script>
        // --- DOM Element Selection ---
        const imageLoader = document.getElementById('imageLoader');
        const canvas = document.getElementById('imageCanvas');
        const ctx = canvas.getContext('2d');
        const downloadBtn = document.getElementById('downloadBtn');
        const downloadContainer = document.getElementById('downloadContainer');
        const instruction = document.getElementById('instruction');
        const errorBox = document.getElementById('error-box');
        const errorMessage = document.getElementById('error-message');

        // --- Load the 'blush' logo ---
        const blushLogo = new Image();
        // This is the provided logo file.
        blushLogo.src = 'https://storage.googleapis.com/gemini-prod-us-west1-assets/d92f827f-8cd5-48b2-b532-5647ed0b0131'; 
        blushLogo.crossOrigin = "Anonymous"; // Required for drawing images from other domains onto canvas

        // --- Event Listener for File Input ---
        imageLoader.addEventListener('change', handleImageUpload);

        /**
         * Handles the file selection, validation, and initiates the image processing.
         * @param {Event} e - The change event from the file input.
         */
        function handleImageUpload(e) {
            hideError();
            const file = e.target.files[0];
            if (!file) return;

            // --- File Type Validation ---
            if (!['image/jpeg', 'image/png'].includes(file.type)) {
                showError('Invalid file type. Please upload a PNG or JPEG image.');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(event) {
                const userImage = new Image();
                userImage.onload = function() {
                    instruction.classList.add('hidden'); // Hide instruction text
                    processImage(userImage);
                    downloadContainer.classList.remove('hidden'); // Show download button
                }
                userImage.src = event.target.result;
            }
            reader.readAsDataURL(file);
        }

        /**
         * Draws the user image, logo, and text onto the canvas.
         * @param {HTMLImageElement} userImage - The user's uploaded image object.
         */
        function processImage(userImage) {
            // --- Set Canvas Dimensions to Match User Image ---
            canvas.width = userImage.width;
            canvas.height = userImage.height;

            // --- Clear canvas and draw user's image ---
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(userImage, 0, 0);

            // --- Artistic Placement of 'blush' Logo ---
            // We wait for the logo to be fully loaded before trying to draw it
            if (blushLogo.complete) {
                drawOverlays();
            } else {
                blushLogo.onload = drawOverlays;
            }
        }

        /**
         * Draws the logo and text overlays. This function is called after the main image and logo are loaded.
         */
        function drawOverlays() {
            // --- Draw the Blush Logo ---
            // Scale logo to be 1/4th of the canvas width for good proportions
            const logoScaleFactor = 4;
            const logoWidth = canvas.width / logoScaleFactor;
            const logoHeight = (logoWidth / blushLogo.width) * blushLogo.height;
            
            // Random position, ensuring the logo stays fully within the canvas bounds.
            const logoX = Math.random() * (canvas.width - logoWidth);
            const logoY = Math.random() * (canvas.height - logoHeight);
            
            ctx.globalAlpha = 0.85; // Make the logo slightly transparent
            ctx.drawImage(blushLogo, logoX, logoY, logoWidth, logoHeight);
            ctx.globalAlpha = 1.0; // Reset alpha for other elements

            // --- Draw "JUNE 2025" Text Randomly ---
            const fontSize = Math.max(20, Math.min(canvas.width / 15, canvas.height / 15)); // Responsive font size
            ctx.font = `bold ${fontSize}px Arial`;
            ctx.fillStyle = 'white';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.shadowColor = 'rgba(0, 0, 0, 0.7)'; // Add a subtle shadow for readability
            ctx.shadowBlur = 10;

            // Add the text multiple times for an artistic effect
            const textToDraw = "JUNE 2025";
            for (let i = 0; i < 3; i++) {
                // Random position within canvas bounds
                const textX = Math.random() * canvas.width;
                const textY = Math.random() * canvas.height;
                ctx.fillText(textToDraw, textX, textY);
            }
            
            // Reset shadow for any future drawing
            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;
        }


        // --- Event Listener for Download Button ---
        downloadBtn.addEventListener('click', function() {
            // Create a temporary link element
            const link = document.createElement('a');
            // Set the filename for the download
            link.download = 'blush-creation.png';
            // Convert canvas content to a data URL (PNG format)
            link.href = canvas.toDataURL('image/png').replace('image/png', 'image/octet-stream');
            // Programmatically click the link to trigger the download
            link.click();
        });

        /**
         * Displays the error message box.
         * @param {string} msg - The error message to display.
         */
        function showError(msg) {
            errorMessage.textContent = msg;
            errorBox.classList.remove('hidden');
        }

        /**
         * Hides the error message box.
         */
        function hideError() {
            errorBox.classList.add('hidden');
        }

    </script>
</body>
</html>
